<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Kategori & Produk | OlehOlehJember</title>

  <!-- FONT -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800;900&display=swap" rel="stylesheet">
</head>

<body id="home">

  <!-- ================= NAVBAR ================= -->
  <header class="nav">
    <div class="container nav__inner">
      <a class="logo" href="index.html" aria-label="Beranda">
        <span class="logo__mark" aria-hidden="true"></span>
        <span class="logo__text">OlehOlehJember</span>
      </a>

      <nav class="nav__links" aria-label="Navigasi">
        <a href="jember.html">Jember</a>
        <a class="isHere" href="kategori.html">Kategori</a>
        <a href="testimoni.html">Testimoni</a>
        <a href="blog.html">Blog</a>
      </nav>

      <div class="nav__actions">
        <button class="btn btn--primary" id="openOrder" type="button">Pesan</button>
        <button class="menuBtn" id="menuBtn" aria-label="Buka menu" aria-expanded="false" aria-controls="mobileMenu">‚ò∞</button>
      </div>
    </div>

    <div class="mobileMenu" id="mobileMenu" hidden>
      <div class="container mobileMenu__inner">
        <a href="jember.html">Jember</a>
        <a class="isHere" href="kategori.html">Kategori</a>
        <a href="testimoni.html">Testimoni</a>
        <button class="btn btn--primary" id="openOrderMobile" type="button">Pesan</button>
      </div>
    </div>
  </header>

  <!-- ================= ORDER MODAL (SAMA UNTUK SEMUA TOMBOL PESAN) ================= -->
  <div class="modal" id="orderModal" hidden aria-hidden="true">
    <div class="modal__backdrop" data-close></div>

    <div class="modal__dialog" role="dialog" aria-modal="true" aria-labelledby="orderTitle">
      <div class="modal__head">
        <div>
          <div class="modal__kicker">Form Pemesanan</div>
          <h3 class="modal__title" id="orderTitle">Pesan Oleh-Oleh Jember</h3>
        </div>
        <button class="modal__close" type="button" aria-label="Tutup" data-close>‚úï</button>
      </div>

      <form class="modal__body" id="orderForm">
        <div class="formGrid">
          <label class="field">
            <span>Nama</span>
            <input name="nama" required placeholder="Nama kamu">
          </label>

          <label class="field">
            <span>No. WhatsApp</span>
            <input name="wa" required placeholder="08xxxxxxxxxx">
          </label>

          <label class="field field--full">
            <span>Alamat (untuk pengiriman)</span>
            <textarea name="alamat" rows="3" required placeholder="Jalan, kecamatan, kota, kode pos"></textarea>
          </label>

          <label class="field">
            <span>Pilih Produk</span>
            <select name="produk" id="produkSelect" required>
              <option value="">‚Äî Pilih ‚Äî</option>
            </select>
          </label>

          <label class="field">
            <span>Jumlah</span>
            <input name="qty" type="number" min="1" value="1" required>
          </label>

          <label class="field field--full">
            <span>Catatan (opsional)</span>
            <input name="catatan" placeholder="Misal: minta kartu ucapan, pedas, tanpa kacang, dll.">
          </label>
        </div>

        <div class="divider"></div>

        <!-- NOTA -->
        <div class="nota" aria-label="Nota sementara">
          <div class="nota__head">
            <h4>Nota sementara</h4>
            <span class="nota__badge">Belum dibayar</span>
          </div>

          <div class="nota__grid">
            <div class="nota__row">
              <span class="k">Produk</span>
              <span class="v" id="notaProduk">‚Äî</span>
            </div>
            <div class="nota__row">
              <span class="k">Jumlah</span>
              <span class="v" id="notaQty">1</span>
            </div>
            <div class="nota__row">
              <span class="k">Harga</span>
              <span class="v" id="notaHarga">Rp 0</span>
            </div>

            <div class="nota__row nota__row--total">
              <span class="k">Total Sementara</span>
              <span class="v" id="notaTotal">Rp 0</span>
            </div>
          </div>

          <div class="nota__note">
            *Total ini sementara. Ongkir/biaya tambahan (jika ada) akan dikonfirmasi admin.
          </div>
        </div>

        <div class="divider"></div>

        <!-- PAYMENT -->
        <div class="pay">
          <div class="pay__head">
            <h4>Pembayaran</h4>
            <p>Pilih metode QRIS. Scan QR di bawah, lalu simpan bukti pembayaran.</p>
          </div>

          <div class="payMethods">
            <label class="payOption">
              <input type="radio" name="metode" value="QRIS BCA" checked>
              <div class="payOption__box">
                <div class="payOption__title">QRIS BCA</div>
                <div class="payOption__sub">Scan QRIS BCA / aplikasi apa pun</div>
              </div>
            </label>

            <label class="payOption">
              <input type="radio" name="metode" value="QRIS Mandiri">
              <div class="payOption__box">
                <div class="payOption__title">QRIS Mandiri</div>
                <div class="payOption__sub">Scan QRIS Mandiri / aplikasi apa pun</div>
              </div>
            </label>
          </div>

          <div class="qrWrap">
            <div class="qrCard" id="qrisBCA">
              <div class="qrTitle">QRIS BCA</div>
              <img class="qrImg" src="assets/qris-bca.png" alt="QRIS BCA (ganti dengan QR kamu)">
              <div class="qrNote">Ganti file QRIS: <b>assets/qris-bca.png</b></div>
            </div>

            <div class="qrCard" id="qrisMandiri" hidden>
              <div class="qrTitle">QRIS Mandiri</div>
              <img class="qrImg" src="assets/qris-mandiri.png" alt="QRIS Mandiri (ganti dengan QR kamu)">
              <div class="qrNote">Ganti file QRIS: <b>assets/qris-mandiri.png</b></div>
            </div>
          </div>

          <label class="field field--full">
            <span>Upload bukti bayar (opsional)</span>
            <input type="file" name="bukti" accept="image/*">
            <small class="hint">Atau kirim bukti via WhatsApp setelah klik ‚ÄúKirim Pesanan‚Äù.</small>
          </label>
        </div>

        <div class="modal__foot">
          <button class="btn" type="button" data-close>Batal</button>
          <button class="btn btn--primary" type="submit">Kirim Pesanan</button>
        </div>
      </form>
    </div>
  </div>

  <!-- ================= DETAIL MODAL ================= -->
  <div class="modal" id="detailModal" hidden aria-hidden="true">
    <div class="modal__backdrop" data-close-detail></div>

    <div class="modal__dialog modal__dialog--detail" role="dialog" aria-modal="true" aria-labelledby="detailTitle">
      <div class="modal__head">
        <div>
          <div class="modal__kicker">Detail Produk</div>
          <h3 class="modal__title" id="detailTitle">‚Äî</h3>
        </div>
        <button class="modal__close" type="button" aria-label="Tutup" data-close-detail>‚úï</button>
      </div>

      <div class="modal__body">
        <div class="detailGrid">
          <div class="detailImgWrap">
            <img id="detailImg" class="detailImg" src="" alt="Foto produk">
          </div>
          <div class="detailInfo">
            <div class="detailBadges">
              <span class="tag" id="detailCat">‚Äî</span>
              <span class="tag tagSoft" id="detailBadge">‚Äî</span>
            </div>

            <p class="detailDesc" id="detailDesc">‚Äî</p>

            <div class="detailPriceRow">
              <div>
                <div class="detailLabel">Harga</div>
                <div class="detailPrice" id="detailPrice">Rp 0</div>
              </div>
              <div>
                <div class="detailLabel">Estimasi</div>
                <div class="detailMeta" id="detailMeta">Siap kirim</div>
              </div>
            </div>

            <div class="detailActions">
              <!-- tombol ini sekarang akan jadi LINK ke halaman detail produk sesuai produk -->
              <a class="btn" id="detailBackLink" href="#" data-close-detail>Kembali</a>
              <button class="btn btn--primary" id="detailOrderBtn" type="button">Pesan Produk Ini</button>
            </div>

            <div class="detailNote">
              *Klik ‚ÄúPesan Produk Ini‚Äù untuk membuka popup pemesanan dan produk otomatis terpilih.
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>


  <!-- ================= HERO ================= -->
  <section class="hero heroPink">
    <div class="container heroGrid">
      <div class="heroText">
        <span class="heroBadge">üå∏ Kategori & Produk</span>
        <h1>Pilih Kategori, Cari Produk, Lalu Pesan</h1>
        <p>
          Tab kategori aktif akan menyaring produk otomatis. Gunakan kolom pencarian untuk menemukan produk lebih cepat.
          Tombol <b>Pesan</b> selalu membuka popup pemesanan yang sama ‚Äî dan jika kamu klik tombol Pesan di kartu produk,
          produk tersebut akan langsung terpilih.
        </p>

        <div class="heroActions">
          <a class="btn btn--primary" href="#kategori">Mulai dari Kategori</a>
          <a class="btn" href="#produk">Langsung ke Produk</a>
        </div>

        <div class="heroMini">
          <div class="miniCard">üì¶ Packing rapi</div>
          <div class="miniCard">‚úÖ QC sebelum kirim</div>
          <div class="miniCard">üßæ Resi cepat</div>
        </div>
      </div>

      <div class="heroImg heroImgPink">
        <img src="https://images.unsplash.com/photo-1555396273-367ea4eb4db5?auto=format&fit=crop&w=1400&q=80" alt="Oleh-oleh">
      </div>
    </div>
  </section>


  <!-- ================= KATEGORI (TABS AKTIF) ================= -->
  <section class="section kategoriSection" id="kategori">
    <div class="container">
      <div class="sectionHead">
        <h2>Kategori Populer</h2>
      </div>

      <div class="gridK">
        <article class="kCard">
          <div class="kCard__media">
            <img src="https://images.unsplash.com/photo-1541976076758-347942db1972?auto=format&fit=crop&w=1200&q=80" alt="Makanan manis">
          </div>
          <div class="kCard__body">
            <h3>Makanan Manis</h3>
            <p>Suwar-suwir, dodol, cookies. Favorit untuk keluarga.</p>
            <div class="kCard__meta">
              <span class="tag">Terlaris</span>
              <span class="tag tagSoft">Tahan perjalanan</span>
            </div>
            <div class="kCard__actions">
              <a class="btn btn--primary" href="#produk" data-jump-filter="makanan">Lihat Produk</a>
              <button class="btn" type="button" data-order="Suwar-suwir Khas">Pesan Cepat</button>
            </div>
          </div>
        </article>

        <article class="kCard">
          <div class="kCard__media">
            <img src="https://images.unsplash.com/photo-1511920170033-f8396924c348?auto=format&fit=crop&w=1200&q=80" alt="Kopi">
          </div>
          <div class="kCard__body">
            <h3>Minuman</h3>
            <p>Kopi dan teh rempah. Wangi, cocok hadiah.</p>
            <div class="kCard__meta">
              <span class="tag">Favorit</span>
              <span class="tag tagSoft">Hadiah</span>
            </div>
            <div class="kCard__actions">
              <a class="btn btn--primary" href="#produk" data-jump-filter="minuman">Lihat Produk</a>
              <button class="btn" type="button" data-order="Kopi Jember">Pesan Cepat</button>
            </div>
          </div>
        </article>

        <article class="kCard">
          <div class="kCard__media">
            <img src="https://images.unsplash.com/photo-1585238342028-4b2a05f52e6c?auto=format&fit=crop&w=1200&q=80" alt="Snack">
          </div>
          <div class="kCard__body">
            <h3>Snack</h3>
            <p>Keripik, edamame crispy, camilan gurih.</p>
            <div class="kCard__meta">
              <span class="tag">Gurih</span>
              <span class="tag tagSoft">Sharing</span>
            </div>
            <div class="kCard__actions">
              <a class="btn btn--primary" href="#produk" data-jump-filter="snack">Lihat Produk</a>
              <button class="btn" type="button" data-order="Edamame Crispy">Pesan Cepat</button>
            </div>
          </div>
        </article>

        <article class="kCard">
          <div class="kCard__media">
            <img src="https://images.unsplash.com/photo-1528825871115-3581a5387919?auto=format&fit=crop&w=1200&q=80" alt="Hampers">
          </div>
          <div class="kCard__body">
            <h3>Hampers</h3>
            <p>Gift box & hampers kantor. Rapi dan elegan.</p>
            <div class="kCard__meta">
              <span class="tag">Rapi</span>
              <span class="tag tagSoft">Kantor</span>
            </div>
            <div class="kCard__actions">
              <a class="btn btn--primary" href="#produk" data-jump-filter="hampers">Lihat Produk</a>
              <button class="btn" type="button" data-order="Hampers Kantor">Pesan Cepat</button>
            </div>
          </div>
        </article>

        <article class="kCard">
          <div class="kCard__media">
            <img src="https://images.unsplash.com/photo-1546549032-9571cd6b27df?auto=format&fit=crop&w=1200&q=80" alt="Paket">
          </div>
          <div class="kCard__body">
            <h3>Paket</h3>
            <p>Paket campur hemat buat yang ingin praktis.</p>
            <div class="kCard__meta">
              <span class="tag">Rekomendasi</span>
              <span class="tag tagSoft">Hemat</span>
            </div>
            <div class="kCard__actions">
              <a class="btn btn--primary" href="#produk" data-jump-filter="paket">Lihat Produk</a>
              <button class="btn" type="button" data-order="Paket Campur Hemat">Pesan Cepat</button>
            </div>
          </div>
        </article>

        <article class="kCard">
          <div class="kCard__media">
            <img src="https://images.unsplash.com/photo-1540189549336-e6e99c3679fe?auto=format&fit=crop&w=1200&q=80" alt="Oleh-oleh">
          </div>
          <div class="kCard__body">
            <h3>Oleh-oleh Kering</h3>
            <p>Ringan, tahan lama, aman untuk perjalanan.</p>
            <div class="kCard__meta">
              <span class="tag">Praktis</span>
              <span class="tag tagSoft">Tahan lama</span>
            </div>
            <div class="kCard__actions">
              <a class="btn btn--primary" href="#produk" data-jump-filter="snack">Lihat Produk</a>
              <button class="btn" type="button" data-order="Keripik Pisang">Pesan Cepat</button>
            </div>
          </div>
        </article>
      </div>

      <div class="moreWrap">
        <a class="btn btn--primary" href="#produk">Scroll ke Produk ‚Üì</a>
      </div>
    </div>
  </section>


  <!-- ================= PRODUK (SEARCH + FILTER) ================= -->
  <section class="section produkSection" id="produk">
    <div class="container">
      <div class="sectionHead">
        <h2>Produk</h2>
        <p>Produk akan otomatis mengikuti tab kategori yang kamu pilih.</p>
      </div>

      <div class="prodTop">
        <div class="searchWrap">
          <input class="searchInput" id="searchInput" type="search"
                 placeholder="Cari produk... (contoh: kopi, suwar, keripik)"
                 aria-label="Cari produk">
        </div>

        <div class="hintBox" id="activeFilterHint" aria-live="polite">
          Filter aktif: <b>Semua</b>
        </div>
      </div>

      <div class="gridP" id="productGrid">
        <!-- dibuat via JS -->
      </div>

      <div class="emptyState" id="emptyState" hidden>
        <div class="emptyIcon">üîé</div>
        <h3>Produk tidak ditemukan</h3>
        <p>Coba ganti tab kategori atau kata kunci pencarian.</p>
        <button class="btn btn--primary" type="button" id="resetBtn">Reset Filter</button>
      </div>

      <div class="moreWrap">
        <button class="btn btn--primary" type="button" id="openOrderBottom">Pesan Sekarang</button>
      </div>
    </div>
  </section>


  <!-- ================= FOOTER ================= -->
  <footer class="footer">
    <div class="container footer__grid">

      <div class="footer__brand">
        <div class="footerLogo">
          <span class="logo__mark" aria-hidden="true"></span>
          <b>OlehOlehJember</b>
        </div>
        <p class="footerMuted">
          Oleh-oleh khas Jember dengan pengemasan rapi, cocok untuk keluarga, teman, dan kebutuhan kantor.
        </p>

        <div class="footerBadges" aria-label="Keunggulan singkat">
          <span class="fBadge">üì¶ Packing Aman</span>
          <span class="fBadge">‚úÖ QC</span>
          <span class="fBadge">üßæ Resi</span>
        </div>
      </div>

      <div class="footer__col">
        <div class="footer__title">Menu</div>
        <a class="footer__link" href="jember.html">Jember</a>
        <a class="footer__link" href="#kategori">Kategori</a>
        <a class="footer__link" href="#produk">Produk</a>
        <a class="footer__link" href="testimoni.html">Testimoni</a>
      </div>

      <div class="footer__col">
        <div class="footer__title">Bantuan</div>
        <a class="footer__link" href="#">Pengiriman</a>
        <a class="footer__link" href="#">Pembayaran</a>
        <a class="footer__link" href="#">FAQ</a>
      </div>

      <div class="footer__col">
        <div class="footer__title">Kontak</div>

        <div class="footerContact">
          <div class="fcItem">
            <span class="fcIcon" aria-hidden="true">üìç</span>
            <div>
              <div class="fcLabel">Lokasi</div>
              <div class="fcText">Jember, Jawa Timur</div>
            </div>
          </div>

          <div class="fcItem">
            <span class="fcIcon" aria-hidden="true">üí¨</span>
            <div>
              <div class="fcLabel">WhatsApp</div>
              <a class="fcText fcLink" id="waLinkFooter" href="#" target="_blank" rel="noopener">Klik untuk chat</a>
            </div>
          </div>

          <div class="fcItem">
            <span class="fcIcon" aria-hidden="true">‚è∞</span>
            <div>
              <div class="fcLabel">Jam Operasional</div>
              <div class="fcText">Setiap hari ‚Ä¢ 08.00‚Äì21.00</div>
            </div>
          </div>
        </div>

        <div class="footerSocial" aria-label="Sosial media">
          <a class="socialBtn" href="#" aria-label="Instagram">IG</a>
          <a class="socialBtn" href="#" aria-label="TikTok">TT</a>
          <a class="socialBtn" href="#" aria-label="Shopee">SP</a>
        </div>
      </div>

    </div>

    <div class="footer__bottom">
      <div class="container footer__bottomInner">
        <div class="footer__copy">
          ¬© <span id="year"></span> OlehOlehJember ‚Ä¢ All rights reserved
        </div>
        <a class="toTop" href="#home">‚Üë Kembali ke atas</a>
      </div>
    </div>
  </footer>


  <!-- ================= GLOBAL CSS (SATU KALI, TIDAK DUPLIKAT) ================= -->
  <style>
    :root{
      --bg: #ffffff;
      --ink: #1e1a1f;
      --muted: rgba(30,26,31,.70);

      --pink: #ff3f9a;
      --pink2:#ff78c3;
      --pinkSoft: rgba(255,63,154,.10);

      --border: rgba(30,26,31,.10);
      --shadow: 0 18px 45px rgba(17,12,18,.08);
      --shadow2: 0 10px 24px rgba(17,12,18,.06);

      --r: 16px;
      --r2: 22px;
      --container: 1120px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; scroll-behavior:smooth; }
    body{
      margin:0;
      font-family:"Plus Jakarta Sans", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--bg);
      color: var(--ink);
    }
    a{ color:inherit; text-decoration:none; }
    .container{ width:min(var(--container), 92vw); margin-inline:auto; }

    /* NAV */
    .nav{
      position: sticky;
      top: 0;
      z-index: 30;
      background: rgba(255,255,255,.92);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--border);
    }
    .nav__inner{
      height: 72px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 14px;
    }
    .logo{ display:flex; align-items:center; gap:10px; font-weight: 900; letter-spacing:-.2px; }
    .logo__mark{
      width: 12px; height: 12px; border-radius: 999px;
      background: linear-gradient(135deg, var(--pink), var(--pink2));
      box-shadow: 0 0 0 6px var(--pinkSoft);
    }
    .logo__text{ font-weight: 900; }

    .nav__links{
      display:flex;
      gap: 18px;
      align-items:center;
      color: var(--muted);
      font-weight: 800;
    }
    .nav__links a{ padding: 10px 10px; border-radius: 12px; }
    .nav__links a:hover{ background: var(--pinkSoft); color: var(--ink); }
    .nav__links a.isHere{ background: var(--pinkSoft); color: var(--ink); }

    .nav__actions{ display:flex; gap:10px; align-items:center; }

    .btn{
      display:inline-flex; align-items:center; justify-content:center;
      padding: 10px 14px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: #fff;
      box-shadow: var(--shadow2);
      font-weight: 900;
      transition: transform .12s ease, box-shadow .12s ease, background .12s ease;
      white-space:nowrap;
      cursor:pointer;
    }
    .btn:hover{ transform: translateY(-1px); box-shadow: var(--shadow); background: rgba(255,255,255,.96); }

    .btn--primary{
      border: none;
      background: linear-gradient(135deg, var(--pink), var(--pink2));
      color:#fff;
      box-shadow: 0 18px 40px rgba(255,63,154,.18);
    }
    .btn--primary:hover{ background: linear-gradient(135deg, #ff2d90, #ff6bbb); }

    .menuBtn{
      display:none;
      width:42px; height:42px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: #fff;
      box-shadow: var(--shadow2);
      font-size: 18px;
      cursor:pointer;
    }

    .mobileMenu{
      border-top: 1px solid var(--border);
      background: #fff;
    }
    .mobileMenu__inner{
      padding: 14px 0 18px;
      display:grid;
      gap: 10px;
    }
    .mobileMenu__inner a{
      padding: 12px 12px;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: #fff;
      font-weight: 900;
      color: var(--muted);
    }
    .mobileMenu__inner a:hover{ background: var(--pinkSoft); color: var(--ink); }
    .mobileMenu__inner a.isHere{ background: var(--pinkSoft); color: var(--ink); }

    @media (max-width: 920px){
      .nav__links{ display:none; }
      .menuBtn{ display:inline-grid; place-items:center; }
    }

    /* HERO */
    .hero{ padding: 72px 0; }
    .heroPink{
      position: relative;
      background:
        radial-gradient(900px 320px at 18% 18%, rgba(255,63,154,.14), transparent 60%),
        radial-gradient(900px 320px at 82% 12%, rgba(255,120,195,.12), transparent 62%),
        linear-gradient(180deg, rgba(255,63,154,.06), #fff 55%);
    }
    .heroPink::after{
      content:"";
      position:absolute;
      inset:0;
      pointer-events:none;
      background: radial-gradient(520px 220px at 35% 75%, rgba(255,63,154,.07), transparent 60%);
    }
    .heroGrid{
      position: relative;
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap: 36px;
      align-items:center;
    }
    .heroBadge{
      display:inline-block;
      padding: 8px 14px;
      border-radius: 999px;
      background: rgba(255,255,255,.85);
      border: 1px solid rgba(255,63,154,.18);
      box-shadow: 0 14px 30px rgba(255,63,154,.08);
      font-weight: 900;
      margin-bottom: 12px;
    }
    .heroText h1{
      margin:0 0 14px;
      font-size: clamp(30px, 4vw, 44px);
      letter-spacing:-.6px;
    }
    .heroText p{
      margin:0;
      color: var(--muted);
      line-height: 1.9;
      font-weight: 650;
      max-width: 62ch;
    }
    .heroActions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin: 16px 0 14px;
    }
    .heroMini{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top: 8px;
    }
    .miniCard{
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,63,154,.18);
      background: #fff;
      box-shadow: var(--shadow2);
      font-weight: 900;
      color: rgba(30,26,31,.78);
      font-size: 13px;
    }
    .heroImg img{
      width:100%;
      border-radius: calc(var(--r2) + 6px);
      border: 1px solid rgba(255,63,154,.18);
      box-shadow: 0 22px 55px rgba(255,63,154,.12), var(--shadow2);
      height: 340px;
      object-fit: cover;
      display:block;
    }
    .heroImgPink{ position: relative; }
    .heroImgPink::before{
      content:"";
      position:absolute;
      inset:-10px;
      border-radius: calc(var(--r2) + 10px);
      background: radial-gradient(closest-side, rgba(255,63,154,.18), transparent 70%);
      filter: blur(10px);
      z-index:-1;
    }

    /* SECTIONS */
    .section{ padding: 72px 0; }
    .sectionHead{ text-align:center; margin-bottom: 18px; }
    .sectionHead h2{ margin:0 0 8px; letter-spacing:-.3px; }
    .sectionHead p{ margin:0; color: var(--muted); font-weight: 650; line-height:1.8; }

    /* Tabs / chips */
    .chipRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:center;
      margin: 10px 0 18px;
    }
    .chip{
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,63,154,.18);
      background:#fff;
      box-shadow: var(--shadow2);
      font-weight: 900;
      color: rgba(30,26,31,.74);
      cursor:pointer;
    }
    .chip:hover{ background: var(--pinkSoft); }
    .chip.isActive{
      background: linear-gradient(135deg, var(--pink), var(--pink2));
      color:#fff;
      border-color: transparent;
      box-shadow: 0 18px 40px rgba(255,63,154,.16);
    }

    /* Kategori area */
    .kategoriSection{
      background:
        radial-gradient(900px 260px at 18% 0%, rgba(255,63,154,.10), transparent 55%),
        radial-gradient(900px 260px at 82% 10%, rgba(255,120,195,.10), transparent 55%),
        #fff;
    }
    .gridK{
      display:grid;
      grid-template-columns: repeat(3, minmax(0,1fr));
      gap: 14px;
    }
    .kCard{
      border-radius: calc(var(--r2) + 6px);
      border: 1px solid rgba(255,63,154,.16);
      background:#fff;
      box-shadow: 0 16px 40px rgba(255,63,154,.08), var(--shadow2);
      overflow:hidden;
      transition: transform .15s ease, box-shadow .15s ease;
      display:flex;
      flex-direction:column;
      min-height: 100%;
    }
    .kCard:hover{
      transform: translateY(-3px);
      box-shadow: 0 20px 55px rgba(255,63,154,.12), var(--shadow);
    }
    .kCard__media img{
      width:100%;
      height: 170px;
      object-fit: cover;
      display:block;
    }
    .kCard__body{
      padding: 16px;
      display:flex;
      flex-direction:column;
      gap: 10px;
      flex: 1 1 auto;
    }
    .kCard__body h3{ margin:0; letter-spacing:-.2px; }
    .kCard__body p{
      margin:0;
      color: var(--muted);
      font-weight: 650;
      line-height: 1.75;
    }
    .kCard__meta{
      display:flex;
      gap: 8px;
      flex-wrap:wrap;
    }
    .tag{
      padding: 8px 10px;
      border-radius: 999px;
      font-weight: 900;
      font-size: 12px;
      border: 1px solid rgba(255,63,154,.18);
      background:#fff;
    }
    .tagSoft{
      background: var(--pinkSoft);
      border-color: rgba(255,63,154,.22);
    }
    .kCard__actions{
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
      margin-top: auto;
    }
    .moreWrap{
      display:flex;
      justify-content:center;
      margin-top: 18px;
    }

    /* Produk */
    .produkSection{
      background:
        radial-gradient(900px 280px at 20% 0%, rgba(255,63,154,.08), transparent 55%),
        #fff;
    }
    .prodTop{
      display:flex;
      gap: 12px;
      justify-content:space-between;
      align-items:center;
      flex-wrap:wrap;
      margin: 10px 0 16px;
    }
    .searchWrap{
      flex: 1 1 320px;
      max-width: 520px;
    }
    .searchInput{
      width:100%;
      padding: 12px 14px;
      border-radius: 16px;
      border: 1px solid rgba(255,63,154,.18);
      background:#fff;
      box-shadow: var(--shadow2);
      font-weight: 800;
      outline: none;
    }
    .searchInput:focus{
      border-color: rgba(255,63,154,.35);
      box-shadow: 0 0 0 4px rgba(255,63,154,.10), var(--shadow2);
    }
    .hintBox{
      padding: 12px 14px;
      border-radius: 16px;
      border: 1px solid rgba(255,63,154,.18);
      background: linear-gradient(135deg, var(--pinkSoft), #fff);
      box-shadow: var(--shadow2);
      font-weight: 800;
      color: rgba(30,26,31,.78);
      white-space:nowrap;
    }

    .gridP{
      display:grid;
      grid-template-columns: repeat(3, minmax(0,1fr));
      gap: 14px;
    }
    .pCard{
      border-radius: calc(var(--r2) + 6px);
      border: 1px solid rgba(255,63,154,.16);
      background:#fff;
      box-shadow: 0 16px 40px rgba(255,63,154,.08), var(--shadow2);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      transition: transform .15s ease, box-shadow .15s ease;
    }
    .pCard:hover{
      transform: translateY(-3px);
      box-shadow: 0 20px 55px rgba(255,63,154,.12), var(--shadow);
    }
    .pImg img{
      width:100%;
      height: 170px;
      object-fit: cover;
      display:block;
    }
    .pBody{
      padding: 16px;
      display:flex;
      flex-direction:column;
      gap: 10px;
      flex: 1 1 auto;
    }
    .pBody h3{ margin:0; letter-spacing:-.2px; }
    .pBody p{ margin:0; color: var(--muted); font-weight:650; line-height:1.75; }
    .pRow{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: 12px;
      margin-top: auto;
    }
    .price{ font-weight: 900; color: var(--pink); }
    .pActions{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:flex-end;
      flex-wrap:wrap;
    }

    .emptyState{
      margin-top: 18px;
      border-radius: calc(var(--r2) + 6px);
      border: 1px dashed rgba(255,63,154,.30);
      background: linear-gradient(135deg, var(--pinkSoft), #fff);
      padding: 22px;
      text-align:center;
      box-shadow: var(--shadow2);
    }
    .emptyIcon{ font-size: 34px; margin-bottom: 8px; }
    .emptyState h3{ margin:0 0 8px; letter-spacing:-.2px; }
    .emptyState p{ margin:0 0 14px; color: var(--muted); font-weight:650; line-height:1.8; }

    /* FOOTER */
    .footer{
      border-top: 1px solid var(--border);
      background: #fff;
      padding: 34px 0 0;
    }
    .footer__grid{
      display:grid;
      grid-template-columns: 1.3fr .9fr .9fr 1.2fr;
      gap: 22px;
      padding-bottom: 22px;
    }
    .footerLogo{
      display:flex;
      align-items:center;
      gap:10px;
      font-weight: 900;
      letter-spacing:-.2px;
    }
    .footerMuted{
      margin: 10px 0 14px;
      color: var(--muted);
      font-weight: 650;
      line-height: 1.8;
      max-width: 52ch;
    }
    .footerBadges{ display:flex; gap: 10px; flex-wrap:wrap; }
    .fBadge{
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,63,154,.18);
      background: var(--pinkSoft);
      font-weight: 800;
      font-size: 12.5px;
    }
    .footer__title{
      font-weight: 900;
      margin-bottom: 10px;
      letter-spacing:-.2px;
    }
    .footer__link{
      display:block;
      padding: 8px 0;
      color: var(--muted);
      font-weight: 800;
    }
    .footer__link:hover{ color: var(--ink); }
    .footerContact{ display:grid; gap: 10px; margin-bottom: 14px; }
    .fcItem{ display:flex; gap: 10px; align-items:flex-start; }
    .fcIcon{
      width: 34px;
      height: 34px;
      border-radius: 12px;
      display:grid;
      place-items:center;
      background: var(--pinkSoft);
      border: 1px solid rgba(255,63,154,.18);
      flex: 0 0 auto;
    }
    .fcLabel{
      font-weight: 900;
      font-size: 12px;
      color: rgba(30,26,31,.62);
      margin-bottom: 2px;
    }
    .fcText{
      color: var(--muted);
      font-weight: 650;
      line-height: 1.6;
      font-size: 13.5px;
    }
    .fcLink{ color: var(--pink); font-weight: 900; }
    .fcLink:hover{ text-decoration: underline; }

    .footerSocial{ display:flex; gap: 10px; flex-wrap:wrap; }
    .socialBtn{
      width: 42px;
      height: 42px;
      border-radius: 14px;
      display:grid;
      place-items:center;
      border: 1px solid rgba(255,63,154,.18);
      background: #fff;
      color: var(--ink);
      font-weight: 900;
      box-shadow: var(--shadow2);
    }
    .socialBtn:hover{
      background: var(--pinkSoft);
      border-color: rgba(255,63,154,.26);
    }

    .footer__bottom{
      border-top: 1px solid var(--border);
      background: #fff;
      padding: 14px 0;
    }
    .footer__bottomInner{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: 12px;
      flex-wrap:wrap;
    }
    .footer__copy{
      color: var(--muted);
      font-weight: 800;
      font-size: 13px;
    }
    .toTop{
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,63,154,.18);
      background: #fff;
      color: var(--muted);
      font-weight: 900;
    }
    .toTop:hover{ background: var(--pinkSoft); color: var(--ink); }

    @media (max-width: 980px){
      .heroGrid{ grid-template-columns: 1fr; }
      .heroImg img{ height: 260px; }
      .gridK, .gridP{ grid-template-columns: 1fr; }
      .hintBox{ width:100%; }
      .footer__grid{ grid-template-columns: 1fr 1fr; }
    }
    @media (max-width: 520px){
      .footer__grid{ grid-template-columns: 1fr; }
    }

    /* MODAL (ORDER + DETAIL) */
    .modal[hidden]{ display:none; }
    .modal{ position:fixed; inset:0; z-index: 999; }
    .modal__backdrop{ position:absolute; inset:0; background: rgba(0,0,0,.45); }

    .modal__dialog{
      position: relative;
      width: min(860px, 92vw);
      margin: 6vh auto;
      border-radius: 22px;
      border: 1px solid rgba(255,63,154,.18);
      background:#fff;
      box-shadow: var(--shadow);
      overflow:hidden;

      max-height: 88vh;
      display:flex;
      flex-direction:column;
    }
    .modal__dialog--detail{ width: min(920px, 92vw); }

    .modal__head{
      padding: 16px 18px;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 12px;
      border-bottom: 1px solid var(--border);
      background: linear-gradient(135deg, var(--pinkSoft), #fff);
      flex: 0 0 auto;
    }
    .modal__kicker{ color: var(--muted); font-weight: 900; font-size: 12px; }
    .modal__title{ margin: 4px 0 0; letter-spacing:-.3px; }
    .modal__close{
      width: 42px; height: 42px;
      border-radius: 14px;
      border: 1px solid var(--border);
      background:#fff;
      box-shadow: var(--shadow2);
      font-size: 16px;
      cursor:pointer;
    }

    .modal__body{
      padding: 16px 18px;
      overflow:auto;
      flex: 1 1 auto;
    }

    /* ORDER FORM */
    .formGrid{ display:grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    .field{ display:grid; gap: 8px; }
    .field--full{ grid-column: 1 / -1; }

    .field span{ font-weight: 900; font-size: 13px; letter-spacing:-.1px; }
    .field input, .field select, .field textarea{
      width: 100%;
      padding: 12px 12px;
      border-radius: 14px;
      border: 1px solid var(--border);
      outline: none;
      font-weight: 700;
      background:#fff;
    }
    .field input:focus, .field select:focus, .field textarea:focus{
      border-color: rgba(255,63,154,.35);
      box-shadow: 0 0 0 4px rgba(255,63,154,.10);
    }
    .hint{ color: var(--muted); font-weight: 700; line-height:1.6; }

    .divider{ height:1px; background: var(--border); margin: 16px 0; }

    /* NOTA */
    .nota{
      border: 1px solid rgba(255,63,154,.18);
      background: linear-gradient(135deg, var(--pinkSoft), #fff);
      border-radius: 18px;
      padding: 14px;
      margin-bottom: 8px;
    }
    .nota__head{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      margin-bottom: 10px;
    }
    .nota__head h4{ margin:0; letter-spacing:-.2px; }
    .nota__badge{
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,63,154,.18);
      background:#fff;
      font-weight: 900;
      font-size: 12px;
      color: var(--muted);
    }
    .nota__grid{ display:grid; gap: 8px; }
    .nota__row{
      display:flex;
      justify-content:space-between;
      gap: 12px;
      padding: 10px 10px;
      border-radius: 14px;
      border: 1px solid var(--border);
      background:#fff;
    }
    .nota__row .k{ color: var(--muted); font-weight: 900; }
    .nota__row .v{ font-weight: 900; }
    .nota__row--total{ border-color: rgba(255,63,154,.22); }
    .nota__row--total .v{ color: var(--pink); }
    .nota__note{
      margin-top: 10px;
      color: var(--muted);
      font-weight: 700;
      font-size: 13px;
      line-height: 1.7;
    }

    /* PAY */
    .pay__head h4{ margin: 0 0 6px; letter-spacing:-.2px; }
    .pay__head p{ margin:0 0 12px; color: var(--muted); font-weight: 700; line-height:1.7; }
    .payMethods{ display:grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px; }
    .payOption{
      display:flex;
      gap: 10px;
      align-items:flex-start;
      border: 1px solid var(--border);
      border-radius: 18px;
      padding: 12px;
      background:#fff;
      box-shadow: var(--shadow2);
      cursor:pointer;
    }
    .payOption input{ margin-top: 4px; }
    .payOption__title{ font-weight: 900; }
    .payOption__sub{ color: var(--muted); font-weight: 700; font-size: 13px; margin-top: 4px; line-height:1.6; }

    .qrWrap{ display:grid; grid-template-columns: 1fr; gap: 12px; margin-bottom: 12px; }
    .qrCard{
      border: 1px solid rgba(255,63,154,.18);
      border-radius: 18px;
      padding: 12px;
      background: linear-gradient(135deg, var(--pinkSoft), #fff);
    }
    .qrTitle{ font-weight: 900; margin-bottom: 10px; }
    .qrImg{
      width: 100%;
      max-width: 320px;
      aspect-ratio: 1 / 1;
      object-fit: contain;
      border-radius: 16px;
      border: 1px solid var(--border);
      background:#fff;
      display:block;
    }
    .qrNote{ margin-top: 10px; color: var(--muted); font-weight: 700; font-size: 13px; line-height:1.6; }

    .modal__foot{
      padding: 14px 18px 18px;
      display:flex;
      justify-content:flex-end;
      gap: 10px;
    }

    /* DETAIL */
    .detailGrid{
      display:grid;
      grid-template-columns: 1fr 1.05fr;
      gap: 16px;
      align-items:start;
    }
    .detailImgWrap{
      border-radius: 18px;
      border: 1px solid rgba(255,63,154,.16);
      background: linear-gradient(135deg, var(--pinkSoft), #fff);
      padding: 12px;
    }
    .detailImg{
      width:100%;
      height: 360px;
      object-fit: cover;
      display:block;
      border-radius: 16px;
      border: 1px solid var(--border);
      background:#fff;
    }
    .detailBadges{ display:flex; gap:8px; flex-wrap:wrap; margin-bottom:10px; }
    .detailDesc{ margin:0 0 14px; color: var(--muted); font-weight:700; line-height:1.85; }
    .detailPriceRow{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-bottom: 14px;
    }
    .detailLabel{ font-weight: 900; font-size: 12px; color: rgba(30,26,31,.62); margin-bottom: 4px; }
    .detailPrice{ font-weight: 900; font-size: 22px; color: var(--pink); letter-spacing:-.2px; }
    .detailMeta{ font-weight: 800; color: rgba(30,26,31,.78); }
    .detailActions{ display:flex; gap:10px; flex-wrap:wrap; }
    .detailNote{ margin-top: 10px; color: var(--muted); font-weight:700; font-size: 13px; line-height:1.7; }

    @media (max-width: 860px){
      .detailGrid{ grid-template-columns: 1fr; }
      .detailImg{ height: 260px; }
    }

    @media (max-width: 700px){
      .formGrid{ grid-template-columns: 1fr; }
      .payMethods{ grid-template-columns: 1fr; }
      .modal__dialog{ margin: 4vh auto; }
    }
  </style>


  <!-- ================= JS (TABS + SEARCH + PESAN + DETAIL) ================= -->
  <script>
    // ================== KONFIG ==================
    // GANTI nomor WA toko kamu di sini (format internasional tanpa +)
    const nomorToko = "6281234567890";

    // Mapping link halaman detail sesuai produk
    const detailLinks = {
      "Suwar-suwir Khas": "detailproduksuwarsuwir.html",
      "Dodol Jember": "detailprodukdodol.html",
      "Cookies Susu": "detailprodukcookiessusu.html",
      "Kopi Jember": "detailprodukkopi.html",
      "Teh Rempah": "detailproduktehrempah.html",
      "Keripik Pisang": "detailprodukkeripikpisang.html",
      "Edamame Crispy": "detailprodukedamamikrispy.html",
      "Gift Box Mix": "detailprodukgiftboxmix.html",
      "Hampers Kantor": "detailprodukhamperskantor.html"
    };

    // Produk master (dipakai untuk render kartu, select, nota, detail)
    const produkData = [
      {
        name: "Suwar-suwir Khas",
        cat: "makanan",
        price: 28000,
        badge: "Terlaris",
        meta: "Siap kirim hari ini",
        desc: "Manis legit, tekstur lembut. Andalan oleh-oleh Jember.",
        img: "https://images.unsplash.com/photo-1541592106381-b31e9677c0e5?auto=format&fit=crop&w=1200&q=80"
      },
      {
        name: "Dodol Jember",
        cat: "makanan",
        price: 25000,
        badge: "Favorit",
        meta: "Tahan perjalanan",
        desc: "Kenyal manis, cocok untuk buah tangan keluarga.",
        img: "https://images.unsplash.com/photo-1604908176997-125f25cc500f?auto=format&fit=crop&w=1200&q=80"
      },
      {
        name: "Cookies Susu",
        cat: "makanan",
        price: 32000,
        badge: "Renyah",
        meta: "Cocok untuk kantor",
        desc: "Renyaaah, cocok buat cemilan di rumah atau kantor.",
        img: "https://images.unsplash.com/photo-1548940740-204726a19be3?auto=format&fit=crop&w=1200&q=80"
      },

      {
        name: "Kopi Jember",
        cat: "minuman",
        price: 55000,
        badge: "Wangi",
        meta: "Cocok hadiah",
        desc: "Aroma wangi, nikmat untuk keluarga atau hadiah.",
        img: "https://images.unsplash.com/photo-1511920170033-f8396924c348?auto=format&fit=crop&w=1200&q=80"
      },
      {
        name: "Teh Rempah",
        cat: "minuman",
        price: 29000,
        badge: "Hangat",
        meta: "Teman sore",
        desc: "Hangat dan wangi. Cocok buat teman sore.",
        img: "https://images.unsplash.com/photo-1544787219-7f47ccb76574?auto=format&fit=crop&w=1200&q=80"
      },

      {
        name: "Keripik Pisang",
        cat: "snack",
        price: 20000,
        badge: "Gurih",
        meta: "Ringan dibawa",
        desc: "Gurih manis, ringan, cocok untuk dibawa jauh.",
        img: "https://images.unsplash.com/photo-1604908177522-4320d06c938c?auto=format&fit=crop&w=1200&q=80"
      },
      {
        name: "Edamame Crispy",
        cat: "snack",
        price: 24000,
        badge: "Renyah",
        meta: "Cocok sharing",
        desc: "Cemilan gurih renyah, cocok buat sharing.",
        img: "https://images.unsplash.com/photo-1599490659213-e2b9527bd087?auto=format&fit=crop&w=1200&q=80"
      },

      {
        name: "Gift Box Mix",
        cat: "hampers",
        price: 99000,
        badge: "Rapi",
        meta: "Siap kirim",
        desc: "Mix snack + kopi + kartu ucapan. Siap kirim.",
        img: "https://images.unsplash.com/photo-1528825871115-3581a5387919?auto=format&fit=crop&w=1200&q=80"
      },
      {
        name: "Hampers Kantor",
        cat: "hampers",
        price: 149000,
        badge: "Elegan",
        meta: "Untuk event kantor",
        desc: "Isi rapi, cocok untuk event kantor & hadiah tim.",
        img: "https://images.unsplash.com/photo-1549465220-1a8e2b28a43a?auto=format&fit=crop&w=1200&q=80"
      },

      {
        name: "Paket Campur Hemat",
        cat: "paket",
        price: 79000,
        badge: "Hemat",
        meta: "Banyak varian",
        desc: "Pilihan aman buat yang ingin banyak varian.",
        img: "https://images.unsplash.com/photo-1540189549336-e6e99c3679fe?auto=format&fit=crop&w=1200&q=80"
      }
    ];

    const catLabel = {
      all: "Semua",
      makanan: "Makanan",
      minuman: "Minuman",
      snack: "Snack",
      hampers: "Hampers",
      paket: "Paket"
    };

    function rupiah(n){
      return "Rp " + (n || 0).toLocaleString("id-ID");
    }
    function normalize(s){
      return (s || "").toLowerCase().trim();
    }

    // ================== ELEMENTS ==================
    const yearEl = document.getElementById('year');
    const waLinkFooter = document.getElementById('waLinkFooter');

    const btnMenu = document.getElementById('menuBtn');
    const menu = document.getElementById('mobileMenu');

    const orderModal = document.getElementById('orderModal');
    const openOrder = document.getElementById('openOrder');
    const openOrderMobile = document.getElementById('openOrderMobile');
    const openOrderBottom = document.getElementById('openOrderBottom');

    const orderForm = document.getElementById('orderForm');
    const produkSelect = document.getElementById('produkSelect');

    const notaProduk = document.getElementById('notaProduk');
    const notaQty = document.getElementById('notaQty');
    const notaHarga = document.getElementById('notaHarga');
    const notaTotal = document.getElementById('notaTotal');

    const qrisBCA = document.getElementById('qrisBCA');
    const qrisMandiri = document.getElementById('qrisMandiri');

    const chips = Array.from(document.querySelectorAll('.chip[data-filter]'));
    const hint = document.getElementById('activeFilterHint');
    const searchInput = document.getElementById('searchInput');
    const emptyState = document.getElementById('emptyState');
    const resetBtn = document.getElementById('resetBtn');
    const productGrid = document.getElementById('productGrid');

    const detailModal = document.getElementById('detailModal');
    const detailTitle = document.getElementById('detailTitle');
    const detailImg = document.getElementById('detailImg');
    const detailCat = document.getElementById('detailCat');
    const detailBadge = document.getElementById('detailBadge');
    const detailDesc = document.getElementById('detailDesc');
    const detailPrice = document.getElementById('detailPrice');
    const detailMeta = document.getElementById('detailMeta');
    const detailOrderBtn = document.getElementById('detailOrderBtn');
    const detailBackLink = document.getElementById('detailBackLink');

    // ================== INIT BASIC ==================
    yearEl.textContent = new Date().getFullYear();
    waLinkFooter.href = `https://wa.me/${nomorToko}`;

    // mobile menu toggle
    btnMenu?.addEventListener('click', () => {
      const open = !menu.hasAttribute('hidden');
      if(open){
        menu.setAttribute('hidden','');
        btnMenu.setAttribute('aria-expanded','false');
      } else {
        menu.removeAttribute('hidden');
        btnMenu.setAttribute('aria-expanded','true');
      }
    });

    // ================== RENDER PRODUK (KARTU + SELECT) ==================
    function renderProduk(){
      // fill select
      produkSelect.innerHTML = `<option value="">‚Äî Pilih ‚Äî</option>` +
        produkData.map(p => `<option value="${p.name}">${p.name}</option>`).join("");

      // render cards
      productGrid.innerHTML = produkData.map(p => {
        const link = detailLinks[p.name] || "#";
        return `
        <article class="pCard" data-cat="${p.cat}" data-name="${p.name}">
          <div class="pImg"><img src="${p.img}" alt="${p.name}"></div>
          <div class="pBody">
            <h3>${p.name}</h3>
            <p>${p.desc}</p>
            <div class="pRow">
              <span class="price">${rupiah(p.price)}</span>
              <div class="pActions">
                <a class="btn" href="${link}" data-detail-link="${p.name}">Detail Produk</a>
                <button class="btn btn--primary" type="button" data-order="${p.name}">Pesan</button>
              </div>
            </div>
          </div>
        </article>
        `;
      }).join("");
    }
    renderProduk();

    function getProdukByName(name){
      return produkData.find(p => p.name === name);
    }

    // ================== ORDER MODAL OPEN/CLOSE ==================
    function showOrderModal(){
      orderModal.removeAttribute('hidden');
      orderModal.setAttribute('aria-hidden', 'false');
      document.body.style.overflow = 'hidden';
      setTimeout(updateNota, 0);
    }
    function hideOrderModal(){
      orderModal.setAttribute('hidden','');
      orderModal.setAttribute('aria-hidden', 'true');
      document.body.style.overflow = '';
    }

    openOrder?.addEventListener('click', showOrderModal);
    openOrderBottom?.addEventListener('click', showOrderModal);
    openOrderMobile?.addEventListener('click', () => {
      menu?.setAttribute('hidden','');
      btnMenu?.setAttribute('aria-expanded','false');
      showOrderModal();
    });

    // close order modal
    orderModal?.addEventListener('click', (e) => {
      const t = e.target;
      if (t && t.hasAttribute('data-close')) hideOrderModal();
    });

    // esc close (order/detail)
    window.addEventListener('keydown', (e) => {
      if (e.key !== 'Escape') return;
      if (!orderModal.hasAttribute('hidden')) hideOrderModal();
      if (!detailModal.hasAttribute('hidden')) hideDetailModal();
    });

    // ================== DETAIL MODAL OPEN/CLOSE ==================
    let detailCurrentProduct = null;

    function showDetailModal(prodName){
      const p = getProdukByName(prodName);
      if(!p) return;

      detailCurrentProduct = p.name;

      detailTitle.textContent = p.name;
      detailImg.src = p.img;
      detailImg.alt = p.name;
      detailCat.textContent = catLabel[p.cat] || p.cat;
      detailBadge.textContent = p.badge || "Produk";
      detailDesc.textContent = p.desc;
      detailPrice.textContent = rupiah(p.price);
      detailMeta.textContent = p.meta || "Siap kirim";

      // SET LINK DETAIL SESUAI PRODUK
      const link = detailLinks[p.name] || "#";
      detailBackLink.href = link;

      detailModal.removeAttribute('hidden');
      detailModal.setAttribute('aria-hidden', 'false');
      document.body.style.overflow = 'hidden';
    }

    function hideDetailModal(){
      detailModal.setAttribute('hidden','');
      detailModal.setAttribute('aria-hidden', 'true');
      document.body.style.overflow = '';
      detailCurrentProduct = null;
      detailBackLink.href = "#";
    }

    // close detail modal
    detailModal?.addEventListener('click', (e) => {
      const t = e.target;
      if (t && t.hasAttribute('data-close-detail')) hideDetailModal();
    });

    detailOrderBtn?.addEventListener('click', () => {
      if(!detailCurrentProduct) return;
      hideDetailModal();
      openWithProduct(detailCurrentProduct);
    });

    // ================== QRIS TOGGLE ==================
    orderForm?.addEventListener('change', (e) => {
      const el = e.target;
      if (el && el.name === 'metode') {
        if (el.value === 'QRIS BCA') {
          qrisBCA.hidden = false;
          qrisMandiri.hidden = true;
        } else {
          qrisBCA.hidden = true;
          qrisMandiri.hidden = false;
        }
      }
    });

    // ================== NOTA (AUTO UPDATE) ==================
    function updateNota(){
      if(!orderForm) return;

      const produk = orderForm.produk.value;
      const qty = parseInt(orderForm.qty.value || "1", 10);

      const p = getProdukByName(produk);
      const harga = p ? p.price : 0;
      const q = isNaN(qty) ? 1 : qty;
      const total = harga * q;

      notaProduk.textContent = produk || "‚Äî";
      notaQty.textContent = String(q);
      notaHarga.textContent = rupiah(harga);
      notaTotal.textContent = rupiah(total);
    }

    orderForm?.addEventListener("input", (e) => {
      if(["produk","qty"].includes(e.target.name)) updateNota();
    });
    orderForm?.addEventListener("change", (e) => {
      if(["produk","qty"].includes(e.target.name)) updateNota();
    });

    // ================== SUBMIT -> WHATSAPP ==================
    orderForm?.addEventListener('submit', (e) => {
      e.preventDefault();
      const form = e.target;

      const nama = form.nama.value.trim();
      const wa = form.wa.value.trim();
      const alamat = form.alamat.value.trim();
      const produk = form.produk.value;
      const qty = form.qty.value;
      const catatan = form.catatan.value.trim();
      const metode = form.metode.value;

      const p = getProdukByName(produk);
      const harga = p ? p.price : 0;
      const total = harga * parseInt(qty || "1", 10);

      const pesan =
`Halo, saya mau pesan:
- Nama: ${nama}
- WA: ${wa}
- Produk: ${produk}
- Jumlah: ${qty}
- Alamat: ${alamat}
- Metode Bayar: ${metode}
- Total Sementara: ${rupiah(total)}
- Catatan: ${catatan || '-'}

Saya akan bayar via QRIS.`;

      const url = `https://wa.me/${nomorToko}?text=${encodeURIComponent(pesan)}`;
      window.open(url, "_blank", "noopener");

      hideOrderModal();
      form.reset();
      qrisBCA.hidden = false;
      qrisMandiri.hidden = true;
      updateNota();
    });

    // ================== OPEN WITH PRODUCT (PESAN DI KARTU PRODUK) ==================
    function openWithProduct(prodName){
      showOrderModal();
      if(orderForm && prodName){
        orderForm.produk.value = prodName;
        orderForm.qty.value = 1;
        updateNota();
        orderForm.produk.dispatchEvent(new Event("change", { bubbles:true }));
      }
    }

    // Delegasi klik untuk tombol Pesan & Detail (produk) + Pesan Cepat (kategori)
    document.addEventListener('click', (e) => {
      const target = e.target;

      // Pesan produk
      const orderBtn = target.closest('[data-order]');
      if(orderBtn){
        const prod = orderBtn.getAttribute('data-order');
        openWithProduct(prod);
        return;
      }

      // (opsional) jika masih mau pakai detail modal dari elemen lain:
      const detailBtn = target.closest('[data-detail]');
      if(detailBtn){
        const prod = detailBtn.getAttribute('data-detail');
        showDetailModal(prod);
        return;
      }
    });

    // ================== TABS AKTIF + SEARCH ==================
    let activeFilter = "all";

    function setActiveTab(filter){
      activeFilter = filter;

      chips.forEach((c) => {
        const isOn = c.dataset.filter === filter;
        c.classList.toggle('isActive', isOn);
        c.setAttribute('aria-selected', isOn ? 'true' : 'false');
      });

      if(hint) hint.innerHTML = `Filter aktif: <b>${catLabel[filter] || "Semua"}</b>`;
      applyFilters();
    }

    function applyFilters(){
      const q = normalize(searchInput?.value);
      const cards = Array.from(document.querySelectorAll('.pCard'));

      let shown = 0;
      cards.forEach((card) => {
        const cat = card.dataset.cat;
        const name = normalize(card.dataset.name);
        const text = normalize(card.innerText);

        const okCat = (activeFilter === "all") ? true : (cat === activeFilter);
        const okSearch = q ? (name.includes(q) || text.includes(q)) : true;

        const show = okCat && okSearch;
        card.style.display = show ? "" : "none";
        if(show) shown++;
      });

      if(emptyState) emptyState.hidden = shown !== 0;
    }

    chips.forEach((chip) => {
      chip.addEventListener('click', () => {
        setActiveTab(chip.dataset.filter || "all");
      });
    });

    searchInput?.addEventListener('input', applyFilters);

    resetBtn?.addEventListener('click', () => {
      if(searchInput) searchInput.value = "";
      setActiveTab("all");
      document.getElementById('produk')?.scrollIntoView({ behavior:"smooth", block:"start" });
    });

    // klik "Lihat Produk" dari kartu kategori -> set filter + scroll
    document.querySelectorAll('[data-jump-filter]')?.forEach((a) => {
      a.addEventListener('click', (e) => {
        e.preventDefault();
        const f = a.getAttribute('data-jump-filter') || "all";
        setActiveTab(f);
        document.getElementById('produk')?.scrollIntoView({ behavior:"smooth", block:"start" });
      });
    });

    // init
    setActiveTab("all");
  </script>

</body>
</html>
